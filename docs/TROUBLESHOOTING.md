# トラブルシューティング

よくある問題と解決方法です。

---

## マクロが実行できない

### 症状
「マクロを有効にできません」エラー

### 解決方法
1. ファイル → オプション → セキュリティセンター
2. セキュリティセンターの設定
3. 「すべてのマクロを有効にする」を選択

---

## 文字化けする

### 症状
VBAモジュールをインポートしたら日本語が文字化け

### 解決方法
`vba/` フォルダ内の **`_SJIS.bas`** ファイルをインポートしてください。

| ファイル | 用途 |
|----------|------|
| `_SJIS.bas` | ✅ Excelにインポート用 |
| `_UTF8.bas` | ❌ 編集・Git管理用（インポート不可） |

---

## 階層が自動設定されない

### 症状
タスクを入力してもA列（LV）が自動更新されない

### 原因
シートモジュールが設定されていない

### 解決方法
1. Alt + F11 でVBAエディタを開く
2. 「InazumaGantt_v2」シートをダブルクリック
3. `vba/SheetModule_SJIS.bas` の内容を貼り付け
4. 保存して閉じる

---

## No.や進捗率が自動入力されない

### 症状
タスクを入力してもB列（No.）、H列（状況）、I列（進捗率）が自動入力されない

### 原因
シートモジュールが設定されていない、または古いバージョン

### 解決方法
1. シートモジュールを最新版で再設定（上記参照）
2. `vba/SheetModule_SJIS.bas` の最新版を使用

---

## ガントチャートが表示されない

### 症状
`RefreshInazumaGantt` を実行してもバーが表示されない

### 原因
- 開始予定/完了予定が入力されていない
- 日付がガントチャートの範囲外

### 解決方法
1. K列（開始予定）とL列（完了予定）に日付を入力
2. 日付がガントチャートの表示範囲内か確認

---

## 今日線が表示されない

### 症状
今日の日付の縦線が表示されない

### 原因
今日の日付がガントチャートの範囲外

### 解決方法
1. `SetupInazumaGantt` を再実行
2. ガントチャートの開始日を今日を含む日付に設定

---

## イナズマ線が表示されない

### 症状
オレンジのイナズマ線が表示されない

### 原因
- 対象となるタスクが2つ未満
- すべてのタスクの開始予定が今日より後

### 解決方法
1. 開始予定日が今日以前のタスクが2つ以上あるか確認
2. 完了済みで完了予定が今日より前のタスクはイナズマ線に含まれない仕様です

---

## 階層色分けが適用されない

### 症状
タスクに色がつかない

### 原因
条件付き書式が設定されていない

### 解決方法
```
Alt + F8 → SetupHierarchyColors → 実行
```

一度実行すれば、以降は自動的に色分けが適用されます。

---

## ダブルクリックで完了にならない

### 症状
タスク行をダブルクリックしても完了にならない

### 原因
シートモジュールが正しく設定されていない

### 解決方法
1. シートモジュールを再設定（上記参照）
2. VBAエディタでエラーがないか確認

---

## それでも解決しない場合

1. **エラーログを確認**
   - `InazumaGantt_ErrorLog.txt`（Excelファイルと同じフォルダ）

2. **開発者向けドキュメント参照**
   - `dev/docs/ARCHITECTURE.md`
   - `dev/docs/CODE_QUALITY.md`

3. **テストを実行**
   - `dev/extra_modules/InazumaGanttTests_SJIS.bas` をインポート
   - Alt + F8 → `RunAllTests` → 実行
