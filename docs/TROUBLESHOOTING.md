# トラブルシューティング

よくある問題と解決方法です。

---

## マクロが実行できない

### 症状
「マクロを有効にできません」エラー

### 解決方法
1. ファイル → オプション → セキュリティセンター
2. セキュリティセンターの設定
3. 「すべてのマクロを有効にする」を選択

---

## 文字化けする

### 症状
VBAモジュールをインポートしたら日本語が文字化け

### 解決方法
`vba/` フォルダ内のファイルは Shift-JIS でエンコードされています。  
UTF-8版ではなく、このフォルダのファイルをインポートしてください。

---

## 階層が自動設定されない

### 症状
タスクを入力してもA列（LV）が自動更新されない

### 原因
シートモジュールが設定されていない

### 解決方法
1. Alt + F11 でVBAエディタを開く
2. 「InazumaGantt_v2」シートをダブルクリック
3. `vba/SheetModule.bas` の内容を貼り付け
4. 保存して閉じる

---

## ガントチャートが表示されない

### 症状
`RefreshInazumaGantt` を実行してもバーが表示されない

### 原因
- 開始予定/完了予定が入力されていない
- 日付がガントチャートの範囲外

### 解決方法
1. K列（開始予定）とL列（完了予定）に日付を入力
2. 日付がガントチャートの表示範囲内か確認

---

## 今日線が表示されない

### 症状
今日の日付の縦線が表示されない

### 原因
今日の日付がガントチャートの範囲外

### 解決方法
1. `SetupInazumaGantt` を再実行
2. ガントチャートの開始日を今日を含む日付に設定

---

## ダブルクリックで完了にならない

### 症状
タスク行をダブルクリックしても完了にならない

### 原因
シートモジュールが正しく設定されていない

### 解決方法
1. シートモジュールを再設定（上記参照）
2. VBAエディタでエラーがないか確認

---

## それでも解決しない場合

1. **エラーログを確認**
   - `InazumaGantt_ErrorLog.txt`（Excelファイルと同じフォルダ）

2. **開発者向けドキュメント参照**
   - `dev/docs/ARCHITECTURE.md`
   - `dev/docs/CODE_QUALITY.md`

3. **テストを実行**
   - `dev/extra_modules/InazumaGanttTests.bas` をインポート
   - Alt + F8 → `RunAllTests` → 実行
