# 機能詳細

InazumaGantt v2.2 の機能一覧と詳細説明です。

---

## 主要機能

### 1. イナズマガントチャート

プロジェクトの進捗を視覚化します。

| 要素 | 色 | 説明 |
|------|-----|------|
| **予定バー** | 薄い灰色 + 黒枠線 | タスクの予定期間（開始予定〜完了予定） |
| **進捗バー** | 紺色 + 黒枠線 | 進捗率に応じた塗りつぶし（予定バー上） |
| **実績バー** | 緑色 | 実際の開始〜進捗位置（予定バーの下） |
| **今日線** | 赤 | 現在の日付（縦線） |
| **イナズマ線** | オレンジ | 各タスクの進捗位置を結ぶ折れ線 |
| **土日列** | RGB(70,70,80) | 濃い灰色で塗りつぶし |

#### イナズマ線の仕様（今日基準型）

イナズマ線は「今日」を基準に、各タスクの進捗状況を視覚化します。

| 条件 | 結ぶ位置（X座標） |
|------|-----------------|
| 開始予定が今日より後 | イナズマ線に含めない（まだ開始していない） |
| 完了済み（100%）かつ完了予定が今日より前 | イナズマ線に含めない（過去のタスク） |
| タスクが完了済み（進捗100%） | 完了予定位置（予定バーの右端） |
| タスクが進行中（進捗1-99%） | 予定バー上の進捗率に応じた位置 |
| タスクが未着手（進捗0%） | 予定バーの開始位置（左端） |

**描画ロジック**:

- 開始予定日が今日以前のタスクのみ対象
- 遅れているタスクは今日線より左に凹む形で表示
- 前倒しのタスクは今日線より右に突き出る形で表示

### 2. 階層型タスク管理

タスクを入力する列で階層が自動決定されます。

| 入力列 | 階層レベル | 用途 | 色分け範囲 |
|--------|-----------|------|-----------|
| C列 | LV1 | 大項目・フェーズ | C〜N列（サーモン） |
| D列 | LV2 | 中項目 | D〜N列（薄い青） |
| E列 | LV3 | 小項目 | E〜N列（薄い緑） |
| F列 | LV4 | 詳細項目 | F〜N列（薄い黄色） |

> 階層色分けは条件付き書式で設定されます。`SetupHierarchyColors` を実行すると、以降は自動的に色分けが適用されます。

### 3. 自動機能

| 機能 | 説明 |
|------|------|
| No.自動入力 | タスク入力時にB列に連番を自動設定 |
| 階層自動判定 | タスク入力時にLV（A列）が自動設定 |
| 進捗率自動入力 | タスク入力時にI列に0%を自動設定 |
| 状況自動入力 | タスク入力時にH列に「未着手」を自動設定 |
| 状況自動更新 | 進捗率に応じて状況が自動変更 |
| ダブルクリック完了 | B列ダブルクリックで即完了（取り消し線・灰色対応） |
| 折りたたみ | Shift+右クリックでLV1配下を非表示/表示 |

---

## マクロ一覧

### 基本マクロ（Alt + F8 で実行）

| マクロ名 | 機能 |
|---------|------|
| `SetupInazumaGantt` | 初回セットアップ（ヘッダー・書式設定） |
| `RefreshInazumaGantt` | ガントチャート更新（バー・イナズマ線描画） |
| `SetupHierarchyColors` | 階層色分け（条件付き書式設定） |
| `ClearHierarchyColors` | 階層色分けをクリア |

### 追加マクロ

| マクロ名 | 機能 | 必要モジュール |
|---------|------|---------------|
| `MigrateToV2Format` | データ移管 | DataMigration_SJIS.bas |
| `RunSetupWizard` | ウィザード起動 | SetupWizard_SJIS.bas |
| `EnsureSettingsSheet` | 設定マスタシート作成 | ― |
| `RenumberRows` | No.列の再採番 | ― |
| `ShiftDates` | 日付一括シフト（祝日考慮） | ― |
| `ExportToPDF` | PDF出力（当月ガント含む） | ― |

---

## 列構成

| 列 | 項目 | 説明 |
|----|------|------|
| A | LV | 階層レベル（自動設定） |
| B | No. | 通し番号（自動設定） |
| C | TASK(LV1) | 大項目 |
| D | TASK(LV2) | 中項目 |
| E | TASK(LV3) | 小項目 |
| F | TASK(LV4) | 詳細項目 |
| G | タスク詳細 | 補足説明 |
| H | 状況 | 未着手/進行中/完了（自動設定） |
| I | 進捗率 | 0〜1 または 0〜100%（自動設定） |
| J | 担当 | 担当者名 |
| K | 開始予定 | 予定開始日 |
| L | 完了予定 | 予定完了日 |
| M | 開始実績 | 実際の開始日 |
| N | 完了実績 | 実際の完了日 |
| O〜 | ガント | ガントチャート領域 |

### 行構成

| 行 | 内容 |
|----|------|
| 6 | 週の開始日（2025/12/29等） |
| 7 | 日付（29, 30, 31, 1, 2...） |
| 8 | 曜日（月, 火, 水...）/ A〜N列のヘッダー |
| 9〜 | データ行 |

---

## ヒント

### 進捗率の入力

以下の形式すべてに対応しています：

- `0.7` → 70%
- `70` → 70%
- `70%` → 70%

### 状況の自動更新

進捗率を入力すると、状況が自動的に変更されます：

- 0% → 未着手
- 1〜99% → 進行中
- 100% → 完了
