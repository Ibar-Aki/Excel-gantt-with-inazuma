# 機能詳細

InazumaGantt v2 の機能一覧と詳細説明です。

---

## 主要機能

### 1. イナズマガントチャート

プロジェクトの進捗を視覚化します。

- **予定バー**: タスクの予定期間（薄い灰色 + 黒枠線）
- **進捗バー**: 進捗率に応じた塗りつぶし（紺色 + 黒枠線）
- **実績バー**: 実際の開始〜完了期間（緑色バー）
- **今日線**: 現在の日付（赤い縦線）
- **イナズマ線**: 各タスクの進捗位置を結ぶ折れ線（オレンジ）

#### イナズマ線の仕様（今日基準型）

イナズマ線は「今日」を基準に、各タスクの進捗状況を視覚化します。

| 条件 | 結ぶ位置（X座標） |
|------|-----------------|
| 開始予定が今日より後 | イナズマ線に含めない（まだ開始していない） |
| 完了済み（100%）かつ完了予定が今日より前 | イナズマ線に含めない（過去のタスク） |
| タスクが完了済み（進捗100%） | 完了予定位置（予定バーの右端） |
| タスクが進行中（進捗1-99%） | 予定バー上の進捗率に応じた位置 |
| タスクが未着手（進捗0%） | 予定バーの開始位置（左端） |

**描画ロジック**:
- 開始予定日が今日以前のタスクのみ対象
- 遅れているタスクは今日線より左に凹む形で表示
- 前倒しのタスクは今日線より右に突き出る形で表示

### 2. 階層型タスク管理

タスクを入力する列で階層が自動決定されます。

| 入力列 | 階層レベル | 用途 | 色 |
|--------|-----------|------|-----|
| C列 | LV1 | 大項目・フェーズ | サーモン |
| D列 | LV2 | 中項目 | 薄い青 |
| E列 | LV3 | 小項目 | 薄い緑 |
| F列 | LV4 | 詳細項目 | 薄い黄色 |

### 3. 自動機能

| 機能 | 説明 |
|------|------|
| 階層自動判定 | タスク入力時にLV（A列）が自動設定 |
| 状況自動更新 | 進捗率に応じて状況が自動変更 |
| ダブルクリック完了 | タスク行をダブルクリックで即完了 |

---

## マクロ一覧

### 基本マクロ（Alt + F8 で実行）

| マクロ名 | 機能 |
|---------|------|
| `SetupInazumaGantt` | 初回セットアップ |
| `RefreshInazumaGantt` | ガントチャート更新 |
| `ApplyHierarchyColors` | 階層別色分け適用 |

### 追加マクロ

| マクロ名 | 機能 | 必要モジュール |
|---------|------|---------------|
| `MigrateToV2Format` | データ移管 | DataMigration.bas |
| `RunSetupWizard` | ウィザード起動 | SetupWizard.bas |

---

## 列構成

| 列 | 項目 | 説明 |
|----|------|------|
| A | LV | 階層レベル（自動設定） |
| B | No. | 通し番号 |
| C | TASK(LV1) | 大項目 |
| D | TASK(LV2) | 中項目 |
| E | TASK(LV3) | 小項目 |
| F | TASK(LV4) | 詳細項目 |
| G | タスク詳細 | 補足説明 |
| H | 状況 | 未着手/進行中/完了（自動） |
| I | 進捗率 | 0〜1 または 0〜100% |
| J | 担当 | 担当者名 |
| K | 開始予定 | 予定開始日 |
| L | 完了予定 | 予定完了日 |
| M | 開始実績 | 実際の開始日 |
| N | 完了実績 | 実際の完了日 |
| O〜 | ガント | ガントチャート領域 |

### 行構成

| 行 | 内容 |
|----|------|
| 6 | 週の開始日（2025/12/29等） |
| 7 | 日付（29, 30, 31, 1, 2...） |
| 8 | 曜日（月, 火, 水...）/ A〜N列のヘッダー |
| 9〜 | データ行 |

---

## ヒント

### 進捗率の入力

以下の形式すべてに対応しています：
- `0.7` → 70%
- `70` → 70%
- `70%` → 70%

### 状況の自動更新

進捗率を入力すると、状況が自動的に変更されます：
- 0% → 未着手
- 1〜99% → 進行中
- 100% → 完了
