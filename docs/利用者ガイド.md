# 進捗管理表 利用マニュアル (v2.2)

## 表の構成

| 列 | 項目名 | 入力内容 |
|---|---|---|
| A | LV | 自動入力（タスクの階層レベル） |
| B | No. | 自動入力（連番） |
| C〜F | TASK | タスク名（階層に応じた列に入力） |
| G | タスク詳細 | 補足情報 |
| H | 状況 | 未着手 / 進行中 / 完了 |
| I | 進捗率 | 0%〜100% |
| J | 担当 | 担当者名 |
| K | 開始予定 | 開始予定日 |
| L | 完了予定 | 完了予定日 |
| M | 開始実績 | 実際の開始日 |
| N | 完了実績 | 実際の完了日 |

---

## タスクの記入方法

### 階層に応じてタスクを入力

タスクの階層（親→子）に応じて、入力する列を変えます。

| 階層 | 入力列 | 例 |
|---|---|---|
| 親タスク | C列 | 計画フェーズ |
| 　子タスク | D列 | 　要件定義 |
| 　　孫タスク | E列 | 　　ヒアリング |
| 　　　ひ孫 | F列 | 　　　詳細確認 |

> **ポイント**: 入力した列に応じて、A列のLVが自動で設定されます。

### 日付と進捗の入力

1. **開始予定・完了予定** (K〜L列) を入力
2. 作業開始時に **開始実績** (M列) を入力
3. 作業中は **進捗率** (I列) を更新
4. 完了時は進捗率を100%にするか、ダブルクリックで完了

---

## ボタン機能

シート上部に3つのボタンがあります。

| ボタン | 機能 | 使うタイミング |
|---|---|---|
| **ガント更新** | ガントチャートを最新状態に再描画 | 日付・進捗を変更した後 |
| **土日切替** | 土日列の表示/非表示を切替 | 画面を広く使いたい時 |
| **書式リセット** | 崩れた罫線・書式を修復 | 表示がおかしくなった時 |

### ガント更新

進捗率や日付を変更しても、ガントチャートは自動更新されません。
変更後は必ず「**ガント更新**」ボタンをクリックしてください。

> **v2.2新機能**: 開始日を変更した場合、日付ヘッダーも自動的に再生成されます。

---

## タスクを完了にする

### 方法1: ダブルクリック（推奨）

**No.列 (B列)** をダブルクリックすると、そのタスクが完了になります。

- 状況 → 「完了」
- 進捗率 → 100%
- 完了実績 → 今日の日付（設定による）
- タスクに取り消し線（設定による）
- タスクを灰色に変更（設定による）

> **設定変更**: 「設定マスタ」シートで上記動作をカスタマイズできます。

### 方法2: 手入力

- 進捗率 (I列) に「100%」を入力
- 状況が自動で「完了」に変わります

---

## タスクの折りたたみ機能（v2.2新機能）

親タスク（LV1）配下の子タスクを非表示にできます。

### 操作方法

**Shift + 右クリック**（C〜F列、LV1行のみ有効）

| 操作 | 結果 |
|---|---|
| LV1行でShift+右クリック | 配下行を非表示 |
| 再度Shift+右クリック | 配下行を表示 |
| 通常の右クリック | コンテキストメニュー表示 |

---

## 便利な機能（v2.2新機能）

### No.自動採番

行を挿入・削除した後に「`RenumberRows`」マクロを実行すると、No.列が再採番されます。

### 日付一括シフト

1. シフトしたい日付セルを選択
2. 「`ShiftDates`」マクロを実行
3. 営業日数を入力（例: 5 または -3）

> 祝日マスタに登録された祝日も考慮されます。

### PDF出力

「`ExportToPDF`」マクロを実行すると、タスク情報と当月末までのガントチャートがPDF出力されます。

---

## ガントチャートの見方

### バーの意味

| 色 | 意味 |
|---|---|
| 薄い灰色 | 予定期間 |
| 紺色 | 進捗（予定に対する進み具合） |
| 緑色 | 実績期間 |

### 線の意味

| 線 | 意味 |
|---|---|
| 赤い縦線 | 今日 |
| オレンジの折れ線 | 進捗の遅れ/進みを示す（イナズマ線） |

---

## フィルター機能

8行目（ヘッダー行）にフィルターが設定されています。
特定の担当者や状況でタスクを絞り込むことができます。

---

## 困ったときは

| 症状 | 対処法 |
|---|---|
| ガントが更新されない | 「ガント更新」ボタンをクリック |
| 罫線が崩れた | 「書式リセット」ボタンをクリック |
| 休日の色がおかしい | 「書式リセット」ボタンをクリック |
| 誤って完了にした | 状況列を手動で「進行中」に戻す |
| 取り消し線を消したい | 対象セルを選択 → 書式設定 → 取り消し線OFF |
