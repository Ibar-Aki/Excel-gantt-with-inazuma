# 📦 データ移管機能

## 概要

既存のガントチャート形式からInazumaGantt v2形式へ、簡単にデータを移管できます。

## 対応している既存形式

| 列 | 項目 |
|----|------|
| A | LV（階層レベル）|
| B | タスク |
| C | 担当者 |
| D | 進捗状況（%表記） |
| E | 開始日 |
| F | 終了日 |

## 移管先（v2形式）

| 列 | 項目 | 備考 |
|----|------|------|
| A | LV | そのまま転送 |
| B | No. | 自動採番 |
| C～F | TASK | LV別に配置 |
| G | タスク詳細 | 空欄 |
| H | 状況 | 進捗から自動設定 |
| I | 進捗率 | 0～1に正規化 |
| J | 担当 | 転送 |
| K | 開始予定 | 転送 |
| L | 完了予定 | 転送 |
| M | 開始実績 | 空欄 |
| N | 完了実績 | 空欄 |

## 使い方

### ステップ1: DataMigration.basをインポート

```
1. Alt + F11 でVBAエディタを開く
2. File → Import File
3. vba_modules/import/DataMigration_SJIS.bas を選択
```

### ステップ2: 既存シートをアクティブにする

移管元のシート（既存のガントチャート）を開きます。

### ステップ3: マクロを実行

```
Alt + F8 → MigrateToV2Format → 実行
```

### ステップ4: 確認ダイアログで「はい」を選択

移管元と移管先が表示されます。問題なければ「はい」をクリック。

### ステップ5: 移管完了

自動的にInazumaGantt_v2シートに移動し、データが移管されます。

## 移管後の作業

### 1. ガントチャートを描画

```
Alt + F8 → RefreshInazumaGantt → 実行
```

### 2. 階層色分けを適用（任意）

```
Alt + F8 → HierarchyColor.ApplyHierarchyColors → 実行
```

### 3. 必要に応じて調整

- タスク詳細（G列）を入力
- 開始/完了実績（M, N列）を入力

## 注意事項

### 安全性
- ✅ 既存シートは**変更されません**
- ✅ データは新しいシート（InazumaGantt_v2）にコピーされます

### 前提条件
- ✅ InazumaGantt_v2シートが事前に作成されている必要があります
  - SetupInazumaGanttマクロを先に実行してください

### データの扱い
- タスク名が空の行はスキップされます
- 進捗率は自動的に0～1の範囲に正規化されます
  - 例: "50%" → 0.5
  - 例: "100" → 1.0

## トラブルシューティング

### 「InazumaGantt_v2シートが見つかりません」

**原因**: v2シートが作成されていません

**解決方法**:
```
1. Alt + F8
2. SetupInazumaGantt を実行
3. もう一度 MigrateToV2Format を実行
```

### 移管件数が0件

**原因**: タスク列（B列）が空です

**解決方法**: 既存シートのB列にタスク名が入力されているか確認してください

---

詳細は [TROUBLESHOOTING.md](TROUBLESHOOTING.md) を参照してください。
