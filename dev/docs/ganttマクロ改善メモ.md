# ガントチャート（Gantt）マクロ 改善メモ

## 目的

既存のガントチャート（Excelマクロ）を、**操作ミス防止・視認性向上・再現性の高い表示制御**という観点で改善するための要件定義および実装仕様書。

---

## 改善要件・仕様一覧

### 1. マクロ線・描画ロジックの改善

- **イナズマ線（進捗線）**:
  - **「今日」の赤線**: 今日の日付列に縦線（赤色/太さ2）を表示。
  - **進捗イナズマ線**: 各タスクの進捗率に応じた位置を折れ線（オレンジ色）で結ぶ。
  - **基準**: 予定より遅れている場合は左側、進んでいる/完了の場合は右側へ伸びる標準形状。
  - マクロの設定期日より前の日付がある場合でも描画可能にする。

### 2. UI・表示制御の改善

- **土日表示切り替え**:
  - 「表示/非表示」ボタンを設置。非表示時は土日列の列幅を0にしてカレンダーを詰める。
- **セットアップキャンセル時の挙動**:
  - 処理中に「×」等でキャンセルされた場合は、処理を中断する（ロールバックは不要）。

### 3. レイアウト・フォーマット統一

- **行・列の設定**:
  - **行高さ**: 22（全行統一）。
  - **列幅**: 以下数値を基準とする。
    - A(LV): 3, B(No): 4
    - C-E(TASK Lv1-3): 4, F(TASK Lv4): 15
    - G(補足): 20, H(状況): 7, I(進捗): 7, J(担当): 7
    - K-L(日付): 8.7
- **罫線・リセット機能**:
  - **リセットボタン**: 表示形式や罫線が崩れた場合にワンクリックで復旧するボタンを用意する。

### 4. 操作性・機能性の向上

- **No.初期セット**:
  - セットアップ時に No.1〜400 を自動で連番入力する。
- **ダブルクリック完了機能**:
  - **No.列(B)** または **LV列(A)** のダブルクリック時のみ、「完了」ステータスに変更する。
  - その他のセル（タスク名など）では反応させない（誤操作防止）。

---

## レイアウト・描画詳細仕様

### ヘッダーエリア構成

- **行構成**:
  - 1行目〜5行目: コマンドボタンエリア（A-H列付近）
  - 7行目: 日付, 8行目: 曜日
- **配色**:
  - ヘッダー行(8行目): 青色背景 (RGB目安: 48, 84, 150), 文字色白。

### ガントチャート描画色

- **予定バー**: 薄い灰色 (RGB目安: 245, 245, 245)
- **進捗バー**: 紺色 (RGB目安: 48, 84, 150)
- **実績バー**: 緑色 (RGB目安: 0, 176, 80) ※完了時のみ
- **イナズマ線**: オレンジ色 (RGB目安: 255, 165, 0)

### UIボタン配置

シート上部（1〜5行目）に以下の制御ボタンを配置する：

1. **ガント更新**: イナズマ線・バーの再描画
2. **土日切替**: 土日列の表示/非表示トグル
3. **書式リセット**: 罫線・背景色の修復
