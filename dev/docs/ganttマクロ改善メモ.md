# ガントチャート（Gantt）マクロ 改善メモ

## 目的
既存のガントチャート（Excelマクロ）を、**操作ミス防止・視認性向上・再現性の高い表示制御**という観点で改善するための要件メモ。

---

## 改善要件一覧

### ① マクロ線の描画条件拡張
- マクロの**設定期日より前の日付**がある場合でも、
  **マクロ線を描画できるようにする**。

### ② 実績線の表示制御
- **作業が完了するまで**、実績線は表示しない。
- 完了フラグが立ったタイミングで初めて表示する。

### ③ イラズマガントの常時表示
- イラズマガント（基準ガント／参照ガント）は
  **常に表示状態**とする。

### ④ 表セットアップ時のキャンセル制御
- 表のセットアップ中に **×ボタン** が押された場合：
  - 途中までの処理も含め、
  - **すべての処理を実行しない（完全キャンセル）**。

### ⑤ 土日表示の切り替え機能
- Gantt表の**土日列**について：
  - 「表示」ボタン → 土日を表示
  - 「非表示」ボタン → 土日を非表示
- ユーザー操作で即時切り替え可能にする。

### ⑥ 行の高さ統一
- 表内の**すべての行の高さを 22 に統一**する。

### ⑦ 罫線自動整形機能
- 見やすく、崩れにくい
  **きれいな罫線を自動で引く機能**を追加する。

### ⑧ 表示形式・罫線のリセット機能
- 表示形式や罫線が崩れた場合に、
  **ワンクリックで復旧**できるようにする。
- 以下のリセットボタンを用意する：
  - 表示形式リセットボタン
  - 罫線リセットボタン

### ⑨ No. 初期セット機能
- No.列を
  - 自動連番で
  - 初期状態にセットする機能を追加する。

### ⑩ 完了ボタンの誤作動防止

#### 基本方針
- **もともと完了している行は、何も変更しない**。

#### 操作ルール
- 以下の操作でのみ「完了」状態にできるようにする：
  - **No.列をクリック**
  - **レベル列をクリック**

- それ以外のセル操作では、
  完了処理が発動しないよう制限する。

---

## 補足
- 本メモは要件定義・実装設計・マクロ改修の
  ベース資料として使用する。
- 実装時は Excel 2016 / Microsoft 365 両対応を前提とする。

