# 🚀 セットアップガイド

InazumaGantt v2.2 のセットアップ手順です。

> [!IMPORTANT]
> **Excelファイル名は自由に変更可能です**  
> ただし、**シート名**（`InazumaGantt_v2`、`祝日マスタ`、`設定マスタ`）は変更しないでください。

---

## 必要なファイル

### VBAモジュール（`vba/` フォルダ内）

| ファイル | 用途 | 必須度 |
|----------|------|--------|
| `InazumaGantt_v2_SJIS.bas` | メイン機能 | ⭐ 必須 |
| `HierarchyColor_SJIS.bas` | 階層色分け（条件付き書式） | ⭐ 必須 |
| `SetupWizard_SJIS.bas` | セットアップウィザード | ⭐ 必須 |
| `SheetModule_SJIS.bas` | シートイベント | ⭐ 必須 |
| `DataMigration_SJIS.bas` | データ移管 | 任意 |

> **注意**: 必ず `_SJIS.bas` 版をインポートしてください。`_UTF8.bas` は編集用です。

---

## セットアップ手順（推奨：ウィザード使用）

### ステップ1: VBAモジュールをインポート

1. **Excelファイル（.xlsm）を開く**

2. **VBAエディタを開く**

   ```
   Alt + F11
   ```

3. **モジュールをインポート**

   ```
   ファイル → ファイルのインポート
   ```

   以下を順番にインポート：
   - ✅ `vba/InazumaGantt_v2_SJIS.bas`
   - ✅ `vba/HierarchyColor_SJIS.bas`
   - ✅ `vba/SetupWizard_SJIS.bas`

4. **確認**

   「標準モジュール」に以下が表示されればOK：

   ```
   標準モジュール
   ├─ InazumaGantt_v2
   ├─ HierarchyColor
   └─ SetupWizard
   ```

### ステップ2: セットアップウィザードを実行

1. **Excelに戻る**

   ```
   Alt + Q
   ```

2. **ウィザードを実行**

   ```
   Alt + F8 → RunSetupWizard → 実行
   ```

3. **開始日を入力**（例: `26/01/01`）

4. **自動設定される内容:**
   - メインシート（InazumaGantt_v2）作成
   - 祝日マスタシート作成
   - 設定マスタシート作成
   - 階層色分け（条件付き書式）
   - ガントチャート描画

### ステップ3: シートモジュールを設定

> ウィザード完了後、シート固有の機能を有効にします。

1. **VBAエディタを開く**

   ```
   Alt + F11
   ```

2. **「InazumaGantt_v2」シートをダブルクリック**

   プロジェクトエクスプローラーで「InazumaGantt_v2」シートを探してダブルクリック

3. **コードを貼り付け**

   `vba/SheetModule_SJIS.bas` の内容を全てコピー＆貼り付け

4. **保存して閉じる**

   ```
   Ctrl + S → Alt + Q
   ```

5. **完了！**

---

## 次のステップ

### タスクを入力

| 列 | 内容 |
|----|------|
| C〜F列 | タスク名（入力位置で階層が決まる） |
| K列 | 開始予定日 |
| L列 | 完了予定日 |

**自動入力される項目:**

- A列（LV）: 階層レベル
- B列（No.）: 連番
- H列（状況）: 「未着手」
- I列（進捗率）: 0%

### ガントチャートを更新

```
Alt + F8 → RefreshInazumaGantt → 実行
```

または、シート上部の「**ガント更新**」ボタンをクリック

---

## データ移管（既存データがある場合）

既存のガントチャートからデータを移行する場合：

1. `vba/DataMigration_SJIS.bas` をインポート
2. 既存シートで `Alt + F8 → MigrateToV2Format → 実行`

---

## v2.2 新機能

| 機能 | 操作 |
|------|------|
| ダブルクリック完了 | B列をダブルクリック → タスク完了 |
| 折りたたみ | Shift + 右クリック（LV1行のC-F列） |
| PDF出力 | `ExportToPDF` を実行 |
| 日付シフト | 日付セルを選択 → `ShiftDates` 実行 |
| No.再採番 | `RenumberRows` を実行 |

### 設定マスタシート

「設定マスタ」シートでダブルクリック完了の動作をカスタマイズできます：

| 設定項目 | デフォルト | 効果 |
|----------|------------|------|
| 機能有効 | TRUE | ダブルクリック完了のON/OFF |
| 完了日自動入力 | TRUE | 完了実績日に今日を自動入力 |
| 取り消し線 | TRUE | タスクに取り消し線を適用 |
| 灰色変更 | TRUE | タスクを灰色に変更 |

---

## トラブルシューティング

問題が発生した場合は [docs/TROUBLESHOOTING.md](../docs/TROUBLESHOOTING.md) を参照。

---

## 開発者向け

追加のモジュールやドキュメントは `dev/` フォルダにあります：

- `dev/extra_modules/` - ErrorHandler, テスト
- `dev/docs/` - システム構成、コード品質ガイド
