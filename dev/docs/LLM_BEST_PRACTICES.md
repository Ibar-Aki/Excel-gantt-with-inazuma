# LLMへの依頼方法 - 学びと今後の改善点

InazumaGantt v2 開発プロジェクトにおける振り返りと、今後のLLMへの依頼時に気を付けるべきポイントをまとめます。

---

## 今回発生した後戻り修正の例

### 1. ガントバーの描画仕様

| 修正回数 | 内容 |
|---------|------|
| 1回目 | 予定バー（灰色）、進捗バー（緑色）で実装 |
| 2回目 | 画像を見せて「この通りにして」→ 予定バー（白抜き+黒枠）、進捗バー（青）に変更 |
| 3回目 | 「予定バーは薄い灰色塗りつぶしで」→ 再修正 |
| 4回目 | 「進捗バーは紺色に」「土日は添付の色に」→ 再修正 |
| 5回目 | 「予定バー高さを6に」「進捗バーに黒枠を」→ 再修正 |

**問題点**: 仕様を段階的に伝えたため、何度も修正が発生

### 2. イナズマ線のロジック

| 修正回数 | 内容 |
|---------|------|
| 1回目 | 単純に進捗位置を結ぶ実装 |
| 2回目 | 「描画方法が間違っている」→ 確認のやり取り |
| 3回目 | 「今日基準型にして」→ ロジック変更 |
| 4回目 | 「完了済み＋完了予定が過去は除外」→ 追加ルール |

**問題点**: 仕様を最初に明確にしなかった

### 3. 階層色分け

| 修正回数 | 内容 |
|---------|------|
| 1回目 | マクロで直接色塗り |
| 2回目 | 「条件付き書式にして」→ 全面書き換え |
| 3回目 | 「塗り範囲をLVに応じて変えて」→ 再修正 |

**問題点**: 実装方法の希望を最初に伝えなかった

---

## 効率的なLLMへの依頼方法

### ✅ 仕様は最初にまとめて伝える

**悪い例**:
```
「ガントバーを描画して」
→ 完成後「色を変えて」
→ 完成後「枠線を付けて」
→ 完成後「高さを変えて」
```

**良い例**:
```
「ガントバーを以下の仕様で描画して：
- 予定バー: 薄い灰色（RGB 245,245,245）+ 黒枠線、高さ6px
- 進捗バー: 紺色（RGB 48,84,150）+ 黒枠線、高さは予定と同じ
- 実績バー: 緑色（RGB 0,176,80）、予定の下に配置」
```

### ✅ 画像を見せる場合は言語化も添える

**悪い例**:
```
「添付画像の通りにして」
```

**良い例**:
```
「添付画像を参考に、以下の点を実装して：
- 上段: 予定バー（白抜き）の中に進捗（青）を塗る
- 下段: 実績バー（緑）を別途配置
- 土日: 画像のRGB値（70,70,80）で塗りつぶし」
```

### ✅ ロジックは条件分岐を明確に

**悪い例**:
```
「イナズマ線を今日基準で描画して」
```

**良い例**:
```
「イナズマ線を以下のロジックで描画して：
- 対象: 開始予定日 ≤ 今日 のタスクのみ
- 除外: 進捗100% かつ 完了予定 < 今日
- 結ぶ位置:
  - 完了済み → 完了予定位置
  - 進行中 → 進捗率に応じた位置
  - 未着手 → 開始予定位置」
```

### ✅ 実装方法の希望があれば先に伝える

**悪い例**:
```
「階層色分けを実装して」
→ 完成後「条件付き書式でやって」
```

**良い例**:
```
「階層色分けを条件付き書式で実装して。
一度マクロを実行すれば以降は自動適用される方式で。」
```

---

## チェックリスト（依頼前に確認）

### 視覚的な要素（UI/描画）

- [ ] 色はRGB値で指定したか？
- [ ] サイズ（高さ、幅、線の太さ）を指定したか？
- [ ] 位置関係（上下左右、重なり）を指定したか？
- [ ] 枠線の有無・色を指定したか？

### ロジック

- [ ] 条件分岐を網羅的に記述したか？
- [ ] 境界条件（0%、100%、今日、過去、未来）を考慮したか？
- [ ] 除外条件を明記したか？

### 実装方法

- [ ] 直接処理 vs 条件付き書式 など希望があるか？
- [ ] 一回限り vs 自動適用 など動作方式の希望があるか？
- [ ] 既存コードとの互換性は必要か？

---

## まとめ

| 原則 | 説明 |
|------|------|
| **具体的に** | 抽象的な依頼は解釈の余地を生む |
| **一度に** | 段階的な依頼は後戻りを生む |
| **数値で** | 色・サイズは数値で指定 |
| **条件を網羅** | ロジックは境界条件まで考慮 |
| **方法も指定** | 実装方法の希望があれば先に伝える |

> 💡 **ポイント**: LLMは与えられた情報を元に「最も一般的」と思われる実装をする。
> 特定の仕様がある場合は、必ず明示的に伝える必要がある。
