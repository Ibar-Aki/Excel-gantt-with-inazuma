# 📦 インストールガイド

## クイックインストール（推奨）

### 方法1: セットアップウィザードを使う ⭐ 最も簡単

1. **Excelファイルを開く**
   ```
   Ganto2026_v2仕様.xlsm を開く
   ```

2. **VBAモジュールをインポート**（初回のみ）
   ```
   Alt + F11 → ファイル → ファイルのインポート
   
   以下を順番にインポート:
   ✓ vba_modules/import/InazumaGantt_v2_SJIS.bas
   ✓ vba_modules/import/HierarchyColor_SJIS.bas
   ✓ vba_modules/import/SetupWizard_SJIS.bas
   ```

3. **セットアップウィザードを実行**
   ```
   Alt + F8 → RunSetupWizard → 実行
   ```

4. **ウィザードの指示に従う**
   - シート作成: はい
   - サンプルデータ: はい（推奨）
   - シートモジュール: はい

**完了！** これでInazumaGantt v2が使えます。

---

## 詳細インストール手順

### ステップ1: 必須モジュールのインポート

#### 1-1. VBAエディタを開く
```
Excel で Alt + F11
```

#### 1-2. モジュールをインポート

**ファイル → ファイルのインポート** を3回実行：

| 順番 | ファイル名 | 必須度 |
|------|-----------|--------|
| 1 | `InazumaGantt_v2_SJIS.bas` | ⭐ 必須 |
| 2 | `HierarchyColor_SJIS.bas` | ⭐ 必須 |
| 3 | `SetupWizard_SJIS.bas` | ⭐ 必須 |
| 4 | `DataMigration_SJIS.bas` | 任意 |
| 5 | `ErrorHandler_SJIS.bas` | 推奨 |
| 6 | `InazumaGanttTests_SJIS.bas` | 開発用 |

#### 1-3. インポート確認

VBAエディタの左側「標準モジュール」に以下が表示されればOK:
```
標準モジュール
├─ InazumaGantt_v2
├─ HierarchyColor
└─ SetupWizard
```

---

### ステップ2: セットアップウィザードを実行

```
Alt + F8 → RunSetupWizard → 実行
```

ウィザードが以下を自動実行:
1. ✅ 必須モジュールのチェック
2. ✅ InazumaGantt_v2 シート作成
3. ✅ サンプルデータ追加（任意）
4. ✅ シートモジュール設定の案内

---

### ステップ3: シートモジュールの設定

#### 3-1. シートモジュールを開く

```
Alt + F11
プロジェクトエクスプローラーで「InazumaGantt_v2」をダブルクリック
```

#### 3-2. コードをコピー&貼り付け

`vba_modules/import/InazumaGantt_v2_SheetModule.bas` の内容を全てコピーして貼り付け

または改善版:
`vba_modules/import/InazumaGantt_v2_SheetModule_Improved.bas`

#### 3-3. 保存して閉じる

```
Ctrl + S で保存
Alt + Q でVBAエディタを閉じる
```

---

## クイックスタート（2回目以降）

既にセットアップ済みの場合:

```
Alt + F8 → QuickStart → 実行
```

これで以下が自動実行されます:
- ガント更新
- 色分け適用

---

## テンプレートファイルの作成（管理者向け）

他のユーザーに配布する用のテンプレートを作成できます。

### 手順

1. **上記のインストール手順を完了**

2. **サンプルデータを削除** （必要に応じて）

3. **名前を付けて保存**
   ```
   ファイル名: InazumaGantt_v2_Template.xlsm
   ファイルの種類: Excelマクロ有効ブック (*.xlsm)
   ```

4. **配布**
   - このテンプレートファイルを配布
   - 受け取った人は開くだけで使用開始可能

---

## トラブルシューティング

### Q1. 「モジュールが見つかりません」エラー

**原因**: VBAモジュールがインポートされていない

**解決方法**:
```
ステップ1（モジュールのインポート）を実行してください
```

### Q2. 「マクロを有効にできません」

**原因**: マクロ設定が無効

**解決方法**:
```
ファイル → オプション → セキュリティセンター 
→ セキュリティセンターの設定
→ すべてのマクロを有効にする（非推奨）
または
→ VBAプロジェクトへのアクセスを信頼する
```

### Q3. 文字化けする

**原因**: UTF-8ファイルをインポートした

**解決方法**:
```
必ず *_SJIS.bas ファイルをインポートしてください
```

### Q4. シートモジュールが動作しない

**原因**: コピー&貼り付けが正しくない

**解決方法**:
```
1. シートモジュールを開く
2. 既存コードを全削除
3. 再度コピー&貼り付け
4. 保存
```

---

## アンインストール

InazumaGantt v2を削除する場合:

### 方法1: シートのみ削除

```
「InazumaGantt_v2」シートを右クリック → 削除
```

### 方法2: 完全削除

```
Alt + F11 → VBAエディタ

以下のモジュールを全て削除:
- InazumaGantt_v2
- HierarchyColor
- SetupWizard
- その他のモジュール

シート「InazumaGantt_v2」も削除
```

---

## 更新方法

新しいバージョンにアップデートする場合:

1. **バックアップ**
   ```
   現在のExcelファイルをコピーして保存
   ```

2. **古いモジュールを削除**
   ```
   VBAエディタで既存モジュールを削除
   ```

3. **新しいモジュールをインポート**
   ```
   新バージョンの *_SJIS.bas をインポート
   ```

4. **RefreshInazumaGantt 実行**
   ```
   データが保持されたまま新機能が使えます
   ```

---

## サポート

問題が発生した場合:

1. **ドキュメントを確認**
   - [README.md](../README.md)
   - [TROUBLESHOOTING.md](../docs/TROUBLESHOOTING.md)
   - [SETUP.md](../SETUP.md)

2. **ログを確認**
   ```
   InazumaGantt_ErrorLog.txt
   （Excelファイルと同じフォルダ）
   ```

3. **テストを実行**
   ```
   Alt + F8 → RunAllTests → 実行
   ```

---

**簡単インストールで快適に使いましょう！ 🚀**
